[
["index.html", "xMAPr - manual 1 Preamble", " xMAPr - manual Stephan Michalik 2018-12-13 1 Preamble Every human being has a highly specific mixture of antibody specificities in the blood, which reflecting the individual history of interactions with body-foreign substances like virulence factors of pathogens. The determination of antigen-specific antibody content is a central quantitative measure for diagnostics and vaccine development. The xMAPr app was designed to analyze xMAP® technology derived serological assay data measured in serial dilutions (hyper-dynamic-range [HDR] data). xMAPr was developed under GNU GENERAL PUBLIC LICENSE Version 3. You may adjust the font size in your browser by using the zoom in and zoom out functionality of your browser. operating system shortcut function MacOS Cmd &amp; + zoom in (larger font) MacOS Cmd &amp; - zoom out (smaller font) Windows Strg &amp; + zoom in (larger font) Windows Strg &amp; - zoom out (smaller font) "],
["introduction.html", "2 Introduction", " 2 Introduction Measuring the antibody response to multiple antigens in biofluids can be achieved using the xMAP® technology supplied by Luminex®. For the multiplexing assay all antigens are covalently bound to small paramagnetic particles (MagPlex™) of unique fluorescence dye combination making it possible to distinguish between the mixed spheres in the full assay. The immune response to some antigens can be extremely strong and extremely weak to others. Thus, the quantitative dynamic range of analysis extends over several orders of magnitude. In a standard measurement, the patient’s plasma/serum is diluted 1000-fold and / or 10000-fold. Since this commonly used approach carries the risk of generating quantitative data close to the detection limit when including multiple antigens with a wide variance in the expected antibody responses. This results in error prone data sets making the interpretation of the data very difficult. An advanced approach has been developed to overcome this issue including a serial dilution based measurement of samples granting results derived from the linear range of each antigen. Figure 2.1: serological assay workflow using the xMAP® technology inspect workflow flow chart The resulting complex data set could not be analyzed to date. Therefore, an iterative analysis procedure was developed and implemented using the programming language R and the shiny framework resulting the the xMAPr app. "],
["installation.html", "3 Installation 3.1 Download xMAPr from GitHub and run locally", " 3 Installation 3.1 Download xMAPr from GitHub and run locally 3.1.1 Requirements R (min. version 3.5.1) https://cran.r-project.org RStudio Desktop (min. version 1.1.414) https://www.rstudio.com/products/rstudio-desktop/ Windows user MUST install RTools https://cran.r-project.org/bin/windows/Rtools/ on C: drive (final path: C:\\RTools) other demanding R packages will be installed on the first startup of the xMAPr app (this might take a while) 3.1.2 Running the app locally1 download the app from github https://github.com/stemicha/xMAPr_app by using the clone or download button after extracting the zip file please open the ui.R or server.R in RStudio select Run external press Run App to start the app (first run will take a while, due to package installations) xMAPr app perform best with Firefox or Chrome web browser↩ "],
["xmapr.html", "4 xMAPr 4.1 xMAPr Analysis", " 4 xMAPr xMAPr was developed to analyze and visualize data from bead-based experiments performed with the xMAP® technology. The whole basis of the the analysis is the utilization of serial dilutions per sample to avoid saturation effects. Figure 4.1 illustrates the mode of operation of xMAPr. Figure 4.1: xMAPr workflow depicted as flow chart [inspect xMA 4.1 xMAPr Analysis 4.1.1 xPONENT® raw data processing For the analysis several files are mandatory. After you performed the serological assay including a coupling control the resulting csv-files can be exported using the xPONENT® software from Luminex® (Figure 4.2). The resulting files can be imported into xMAPr, which will automatically genrate the correct input files for the analysis. Figure 4.2: xPonent csv-file export inspect xPonent csv-file export The gerated raw input files can be inspected and manipulated after prepartion since they are stored as easily accessible txt-files in case of naming errors or removale of specific samples for the later analysis (e.g. included standard wells to monitor the inter-plate reproduceability). If multiple csv-files should be used for the generation of the xMAPr input files, make sure to store them all in one folder for the upload selection. When all necessary files are selected start processing the data by clicking on the “Run data processing”-button. When processing is done you can download the raw txt-files as a zip-folder by clicking on the green download button. Figure 4.3: xMAPr xPONENT® raw file processing screenshot inspect xMAPr xPONENT® raw file processing screenshot 4.1.2 xMAPr analysis pipeline the resulting files from the raw file processing step are mandatory for the analysis with xMAPr: assay MFI file assay bead count file coupling control MFI file coupling control bead count file sample meta data (additional file, which provides all the sample meta data !) In addition to the above mentioned files several parameters can be set (figure 4.4). Figure 4.4: xMAPr anaylsis pipeline screenshot inspect xMAPr anaylsis pipeline screenshot If a naming parameter does not fit the input data frames the pipeline will detect that and will report the error in a pop-up error message. What will be checked? is the used dilution name found in assay data header is the used dilution name found in assay bead count data header is the used dilution name found in assay data header is the used replicate name found in assay bead count data header is the used sample name found in assay data header is the used sample name found in assay bead count data header is the used sample name found in meta data header is the used blank name found in assay data first column is the used blank name found in assay bead count data first column is the used antiTag name found in coupling control data first column is the used antiTag name found in coupling control bead count data first column is the used blank name found in coupling control data first column is the used blank name found in coupling control bead count data first column do assay data and control coupling data share the same number of antigens or antigens and do they have the same order do assay bead count data and control coupling bead count data share the same number of antigens and do they have the same order do control coupling bead count data and control coupling data share the same number of antigens or antigens and do they hove the same order is the used number of dilutions below 5 (min. 5 different dilutions required !) Figure 4.5: xMAPr anaylsis pipeline error pop-up (used antiTag name was wrong) In the first instance of the pipeline, the data are corrected for their measurement background, bead count and normalized to their respective coupling efficiency. This is followed by the process of sequential multiple regression. Here, a saturation curve regression model is first assumed and calculated by means of “non-least squared”. If such a calculation is not possible, a linear regression is assumed. If this calculation is successful, even a 50-fold dilution of the patient sample is still in the linear range and the respective antigen thus shows a very low immune response. In order to obtain individual quantitative values per patient and antigen, the different individual regression curves had to be converted into a meaningful value, whereby the antibody titer, which is represented over the individual dilution stages, represents the most important quantitative quantity. Here, in the saturation curve model, the half-maximal intensity was multiplied by the reciprocal dilution at the half-maximal intensity (e.g., half maximal norm. MFI intensity = 50 &amp; dilution at half maximalnorm. MFI intensity = 0.001 --&gt; 50 * (1 / 0.001) = immune response of 50,000). Linear regression multiplies the first serial dilution step by the intensity at that step. This results in a very small quantitative value. xMAPr will perform multiple regression modeling on the data of each sample/antigen combination and subsequently decide which fit type is most characteristic for the sample/antigen specific data (decision tree figure 4.6) 4.1.2.1 Decision tree The decision tree was build to elucidate the best fit for the data. Figure 4.6: xMAPr decision tree inspect xMAPr decision tree 4.1.3 xMAPr data inspection In addition to the data analysis pipeline xMAPr possess a interactive data inspection modul, which allows the user to easily check the fits and the resulting response values. 4.1.3.1 global analysis inspection (Screenshots) Figure 4.7: xMAPr anaylsis output data inspection &gt;&gt; global overview inspect xMAPr anaylsis output data inspection &gt;&gt; global overview The overview of responses (figure 4.7) tab depicts the used fit count histogram (figure 4.7 left plot), which should have a majority of nls (non-least squared) fits (saturation curve fits). A nls_with_exclusion fit - is a nls fit that appears to posses a signal drop in the first sample dilutions in the measured curve. This happens if the secondary antibody did not saturate the bound sample antibodies on the bead. Therefore the automatic detection of a signal drops in the dilution response curve will flagged and not use the responsible data points for the fit (nls_wih_exclusion). If linear fits were used for the majority of curve fittings the used serial dilution range did not end up in a saturation making a saturation curve fit impossible. The resulting response data should be used carefully ! In that case a one dilution data analysis is more reasonable. The dynamic range of responses plot (figure 4.7 center plot) depicts the dynamic range which is covered by the data over all sample and antigen combinations used. Figure 4.8: xMAPr anaylsis output data inspection &gt;&gt; global overview (interactive hover feature) inspect xMAPr anaylsis output data inspection &gt;&gt; global overview (interactive hover feature) The fit type histogram ((figure 4.7 right plot) displays the used fit histogram in correlation to the calculated response. In the example screenshot it apparent that the nls_with_exclusion is primarily being used in the high response range. This makes sense since a high sample antibody titer against one antigen is resulting in a very high load of the sample antibodies on the individual bead. Thus a signal drop in the very first dilutions (low sample dilution) are more likely to happen. The dilution wise dynamic range plots (figure 4.9) tab depicts intensity ranked order of sample/antigen combinations (x-axis) versus log. MFI (median fluorescence intensity) (y-axis). The plot is being used for visually estimating the saturation effect (upper and lower LOD) in each dilution used. Figure 4.9: xMAPr anaylsis output data inspection &gt;&gt; dynamic range dilution wise inspect xMAPr anaylsis output data inspection &gt;&gt; dynamic range dilution wise 4.1.3.2 global analysis inspection: quality check of data (Screenshots) It is important to evaluate the data quality (figure 4.10; quality measures &gt; general overview). Therefore basic measures like the bead count or coefficient of variation between technical replicates are very informative in terms of quality. A bead count below 35 beads results by default (factory suggestion) in a missing value since the MFI (Median fluorescence intensity) is unsure using only 35 beads or below. The CV cut-off can be set in the pipeline settings (figure 4.4) Figure 4.10: xMAPr quality measures: bead count and CV histograms inspect xMAPr quality measures: bead count and CV histograms Since a EDC-NHS coupling of the carboxylated beads with the desired antigens is being used the coupling efficiency might be varying due to the differences in amino acid composition and length of the antigens. The coupling control plot (figure 4.11) displays in a ranked fasion the coupling efficiency measured with a detection antibody directed against the recombinant tag the antigens. The interactive hover feature returns the absolute value measured for each antigen. The MFI of the coupling control (quality measures &gt; coupling control) represents the loading of the beads with the individual antigens, which can be different but should not be very low to keep a certain dynamic range for the detection of the antibody titer. Figure 4.11: xMAPr quality measures: MFI of coupling control inspect xMAPr quality measures: MFI of coupling control The noise MFI (figure 4.12) (quality measures &gt; noise MFI) depicts the ranked ordered mean BLANK values + 3 x SD of the BLANK values, which is being used to estimate the LOD (limit of detection) for each antigen. Again the interactive hover feature show details for each entigen. Figure 4.12: xMAPr quality measures: LOD…limit of detection inspect xMAPr quality measures: LOD…limit of detection The stacked barplots (figure 4.13) (quality measures &gt; bead-count and LOD filtering) are displaying the filtering for low bead count, for CV filtering with the used cut-off and showing how many fits failed or get rejected. Figure 4.13: xMAPr quality measures: stacked barplots of value filtering inspect xMAPr quality measures: stacked barplots of value filtering Figure 4.14: xMAPr quality measures: stacked barplots of value filtering (interactive hover) The implemented signal drop detection alg. uses the maximum value of the measured data points and inspect the data points with a lower dilution begining from the maximal MFI data point (quality measures &gt; dilution-wise signal drop filtering). For example signal drops in the first dilution step of the serial dilution range is normal. But also having a huge amount of signal drops in later dilutions is the result of using a low concentration of the detection antibody or the dilution steps were not well choosen. Figure 4.15: xMAPr quality measures: stacked barplots of dilution-wise signal drop detection (interactive hover) “xMAPr quality measures: stacked barplots of dilution-wise signal drop detection The interative hover feature (figure 4.14) displays information like which antigen, the count of filtered values and what is the percentage of filtered values form the data matrix. Making it easy to identify problematic antigen or sample candidates. Figure 4.16: xMAPr quality measures: NA (missing) value heatmap inspect xMAPr quality measures: NA (missing) value heatmap The missing value heatmap (figure 4.16) (quality measures &gt; heatmap of NA values) depicts in a compact format where and how many values are missing the the dataset after the response calculation was performed. Figure 4.17: xMAPr quality measures: bead count heatmap inspect xMAPr quality measures: bead count heatmap The bead count heatmap (figure 4.17) (quality measures &gt; bead count heatmap) is designed for quickly identifying problematic antigens or patient samples over the dilution series, which also often resulting in a low bead count. 4.1.3.3 global data analysis: PCA &amp; heatmap A first look at the data can be performed in the xMAPr app. A PCA (principle component analysis) is automatically generated plotted and colored based on the selected meta data. Figure 4.18: xMAPr anaylsis output data inspection &gt;&gt; 2D-PCA of data colored by selected meta data inspect xMAPr anaylsis output data inspection &gt;&gt; 2D-PCA of data colored by selected meta data The principle component analysis is performed using the factomineR package with missing values removed. The data centering was done by subtracting the column means (omitting NAs) of the data from their corresponding columns. To unify variances scaling of data was done by dividing the (centered) columns of the data by their standard deviations. The 2D PCA (figure 4.18) (2D PCA) displays the resulting PCA plot. 1D density plots supporting the interpretaion of the PCA results. The PCA dimension for the plot can be be selected using the knobs. Furthermore advanced plot adjustment like group ellipsis can be set as well using the “wrench” button. Figure 4.19: xMAPr anaylsis output data inspection &gt;&gt; interactive 3D-PCA colored by selected meta data inspect xMAPr anaylsis output data inspection &gt;&gt; interactive 3D-PCA colored by selected meta data The 3D PCA (figure 4.19) (3D PCA) displays the resulting PCA plot in the first 3 dimensions. Figure 4.20: xMAPr anaylsis output data inspection &gt;&gt; screeplot of PCA analysis inspect xMAPr anaylsis output data inspection &gt;&gt; screeplot of PCA analysis The Screeplot visualize the variances of dimensions of the PCA (figure 4.20) (Scree plot of PCA). Figure 4.21: xMAPr anaylsis output data inspection &gt;&gt; response heatmap inspect xMAPr anaylsis output data inspection &gt;&gt; response heatmap The heatamp (figure 4.21) (heatmap (response data)) displays the clustered heatmap of the calculated response data. If a sample or a antigen possess only NA values it is excluded from the heatmap, which is indicated in the grey text below the “download heatmap” button. The heatmap is fully interactive with hover information feature, zoom and screenshot feature. Furthermore the heatmap can be download in its interative form as html using the “download heatmap” button. Several parameters can be set like number of clusters of rows and columns or cluster methods to name a few. 4.1.3.4 single antigen/sample inspection (Screenshots) Figure 4.22: xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination fit inspection inspect xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination fit inspection The single result view (figure 4.22) (inspect analysis/response table) enables a inspection of the data down to raw data level by diplaying the results on a antigen/sample combination basis. The upper panel displays the different presentations of the data. The left plot displays the raw data and the dashed red line indicate the LOD. In addition detected signal drops were marked with a blue cross. The center plot displays the calulated curve and the curve point, which is being used for the response calculation. The dashed violett vertical line inidcating the lower and upper end of the used dilution steps. The right plot displays the residuals from the used fit. Figure 4.23: xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination fit inspection (antigen selection) inspect xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination fit inspection (antigen selection) Figure 4.24: xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination fit inspection (log. scale) inspect xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination fit inspection (log. scale) When hitting the e.g. log. scale buttons the plots were generated using a log. scale on the selected axis (figure 4.24). One method to choose the antigen and sample which should plotted are the drop down selection list (figure 4.23). In the elements the desired selection can also being typed in. Another method to choose the antigen and sample which should plotted is to use the interactive data table in the lower panel of the inspect analysis/reponse (figure 4.25. The desired antigen/sample combination can be directly selected inside the table and when looking for a antigen or sample the search field is very helpful. Figure 4.25: xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination fit inspection (interactive data table) inspect xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination fit inspection (interactive data table) In addition if the highlight select antigen/sample combination in global plots? is being switch on the selected antigen/sample combination is being marked in the global plots (figure 4.26 &amp; 4.27). Figure 4.26: xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination marked in global dynamic range plots over dilutions xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination marked in global dynamic range plots over dilutions Figure 4.27: xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination marked in global dynamic range plots xMAPr anaylsis output data inspection &gt;&gt; single antigen/sample combination marked in global dynamic range plots 4.1.3.5 statistical analysis of calculated response data (Screenshots) The statistical data analysis is based on samples groups defined by the selected meta data. A wilcox rank sum test is performed using multiple test correction if the number of groups are more than two. The test statistics with p-value, adjusted p-value and confidence intervals etc. can be interactively inspected and the data is plotted using a violin plot with a bars indicating significant changes. Figure 4.28: xMAPr anaylsis output data inspection &gt;&gt; statistical anaylsis using a wilcox ranked sum test on sample reponse data and the the selcted meta data for grouping inspect xMAPr anaylsis output data inspection &gt;&gt; statistical anaylsis using a wilcox ranked sum test on sample reponse data and the the selcted meta data for grouping Figure 4.29: xMAPr anaylsis output data inspection &gt;&gt; statistical anaylsis using a wilcox ranked sum test on sample reponse data and the the selcted meta data for grouping (meta data selection) inspect xMAPr anaylsis output data inspection &gt;&gt; statistical anaylsis using a wilcox ranked sum test on sample reponse data and the the selcted meta data for grouping (meta data selection) "],
["used-r-packages-for-xmapr.html", "5 used R-packages for xMAPr", " 5 used R-packages for xMAPr R: A Language and Environment for Statistical Computing (R Core Team (2018)) bookdown: Authoring Books and Technical Documents with R Markdown (Xie (2018a)) rmarkdown: Dynamic Documents for R (Allaire et al. (2018)) data.table: Extension of data.frame (Dowle and Srinivasan (2018)) DT: A Wrapper of the JavaScript Library ‘DataTables’ (Xie (2018b)) factoextra: Extract and Visualize the Results of Multivariate Data Analyses (Kassambara and Mundt (2017)) FactoMineR: Multivariate Exploratory Data Analysis and Data Mining (Husson et al. (2018)) ggrepel: Automatically Position Non-Overlapping Text Labels with ‘ggplot2’ (Slowikowski (2018)) ggsignif: Significance Brackets for ‘ggplot2’ (Ahlmann-Eltze (2017)) gridExtra: Miscellaneous Functions for “Grid” Graphics (Auguie (2017)) heatmaply: Interactive Cluster Heat Maps Using ‘plotly’ (Galili (2018)) knitr: A General-Purpose Package for Dynamic Report Generation in R (Xie (2018c)) magrittr: A Forward-Pipe Operator for R (Bache and Wickham (2014)) minpack.lm: R Interface to the Levenberg-Marquardt Nonlinear Least-Squares Algorithm Found in MINPACK, Plus Support for Bounds (Elzhov et al. (2016)) plotly: Create Interactive Web Graphics via ‘plotly.js’ (Sievert et al. (2018)) RColorBrewer: ColorBrewer Palettes (Neuwirth (2014)) reshape: Flexibly Reshape Data ((???)) reshape2: Flexibly Reshape Data: A Reboot of the Reshape Package ((???)) rlang: Functions for Base Types and Core R and ‘Tidyverse’ Features (Henry and Wickham (2018)) scales: Scale Functions for Visualization (Wickham and Seidel (2018)) shiny: Web Application Framework for R (Chang et al. (2018)) shinyalert: Easily Create Pretty Popup Messages (Modals) in ‘Shiny’ (Attali and Edwards (2018)) shinyBS: Twitter Bootstrap Components for Shiny (Bailey (2015)) shinycssloaders: Add CSS Loading Animations to ‘shiny’ Outputs (Sali (2017)) shinydashboard: Create Dashboards with ‘Shiny’ (Chang and Borges Ribeiro (2018)) shinyFiles: A Server-Side File System Viewer for Shiny (Pedersen, Nijs, and Nantz (2018)) shinyjs: Easily Improve the User Experience of Your Shiny Apps in Seconds (Attali (2018)) shinyWidgets: Custom Inputs Widgets for Shiny (Perrier, Meyer, and Granjon (2018)) tidyverse: Easily Install and Load the ‘Tidyverse’ (Wickham (2018)) "]
]
